<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

    <title>Intitulé de ma page</title>
  </head>

  <body style="background-color: black">
    <div id="app"></div>
  </body>
  <script type="module">
    import * as THREE from 'https://cdn.skypack.dev/three@0.130.0';
    import { OrbitControls } from 'https://cdn.skypack.dev/three@0.130.0/examples/jsm/controls/OrbitControls.js';
    import { SVGLoader } from 'https://cdn.skypack.dev/three@0.130.0/examples/jsm/loaders/SVGLoader.js';

    // svg.js
    const material = new THREE.MeshStandardMaterial({
      color: '#fff',
      roughness: 0,
      metalness: 0,
    });
    const renderSVG = (extrusion, svg) => {
      const loader = new SVGLoader();
      const svgData = loader.parse(svg);
      const svgGroup = new THREE.Group();

      svgGroup.scale.y *= -1;
      svgData.paths.forEach((path) => {
        const shapes = SVGLoader.createShapes(path);

        shapes.forEach((shape) => {
          const meshGeometry = new THREE.ExtrudeGeometry(shape, {
            depth: extrusion,
            bevelEnabled: false,
          });
          const mesh = new THREE.Mesh(meshGeometry, material);

          svgGroup.add(mesh);
        });
      });

      const box = new THREE.Box3().setFromObject(svgGroup);
      const size = box.getSize(new THREE.Vector3());
      const yOffset = size.y / -2;
      const xOffset = size.x / -2;

      // Offset all of group's elements, to center them
      svgGroup.children.forEach((item) => {
        item.position.x = xOffset;
        item.position.y = yOffset;
      });

      return {
        object: svgGroup,
      };
    };
    // scene.js
    const setupScene = (container) => {
      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(
        50,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );

      const renderer = new THREE.WebGLRenderer({
        antialias: true,
        alpha: true,
      });
      renderer.setSize(window.innerWidth, window.innerHeight);
      container.append(renderer.domElement);

      const ambientLight = new THREE.AmbientLight('#444');
      const pointLight = new THREE.PointLight('#fff', 2, 800);
      pointLight.position.set(200, 200, 200);

      scene.add(ambientLight, pointLight);

      camera.position.x = 0;
      camera.position.y = -25;
      camera.position.z = 400;

      return { renderer, scene, camera };
    };
    // svg.js
    const svg = `<svg
   version="1.1"
   id="svg1"
   width="200"
   height="200"
   viewBox="0 0 200 200"
   sodipodi:docname="proxy-image.svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <defs
     id="defs1" />
  <sodipodi:namedview
     id="namedview1"
     pagecolor="#505050"
     bordercolor="#ffffff"
     borderopacity="1"/>
  <g
     id="g1">
    <path
       style="fill:#000000"
       d="m 0,184 v -16 h 100 100 v 16 16 H 100 0 Z m 111.78479,8.92518 C 115.671,191.57044 118,188.07266 118,183.59095 v -3.47942 l -2.283,-2.65414 -2.28299,-2.65415 -4.66926,-0.52629 -4.66925,-0.52629 -3.04775,3.04775 L 98,179.84615 v 3.64267 c 0,4.84597 1.494862,7.38571 5.32874,9.05342 3.9052,1.69873 4.59229,1.72985 8.45605,0.38294 z M 104.63486,187.92742 102,185.85484 v -1.92742 C 102,181.49558 105.42567,178 107.80887,178 c 2.43797,0 4.84553,2.01615 5.65226,4.73335 l 0.66308,2.23335 -2.51665,2.51665 c -3.05009,3.05009 -3.61403,3.086 -6.9727,0.44407 z M 64,190.5 64.950498,188 h 2.889892 2.889893 L 73.365141,185.92742 76,183.85484 v -2.31664 c 0,-1.27415 -0.816106,-3.32448 -1.813569,-4.55629 l -1.813569,-2.23967 -5.181264,-0.49785 -5.181264,-0.49786 -1.505167,1.24918 L 59,176.24489 v 6.79577 c 0,3.73767 0.273145,7.50757 0.606989,8.37755 C 60.526616,193.81472 62.9308,193.31221 64,190.5 Z m 0.387326,-7.93303 c -1.386319,-3.61269 1.984306,-5.88515 5.461067,-3.68183 l 1.348393,0.85451 -0.356944,1.88018 -0.356943,1.88017 -2.747135,0.31697 -2.747135,0.31697 z M 83.818046,190.5 c 0.626492,-1.375 1.520283,-2.5 1.986201,-2.5 0.465919,0 1.904008,1.125 3.195753,2.5 1.291745,1.375 2.965578,2.5 3.719627,2.5 h 1.370999 l -0.63512,-3.38548 -0.635119,-3.38548 1.089806,-0.67354 C 94.509587,185.18506 95,183.40327 95,181.59597 v -3.28599 l -2.081379,-1.88363 -2.081378,-1.88362 -5.668622,-0.0214 L 79.5,174.5 79.212474,183.75 78.924948,193 h 1.877011 1.877011 z m 0.365532,-9.25 0.316422,-2.75 2.087505,-0.29826 2.087506,-0.29825 1.284939,1.54825 L 91.244889,181 90,182.5 c -0.684689,0.825 -2.344679,1.5 -3.688867,1.5 h -2.443978 z m 52.517392,10.2469 c 1.18028,-0.82671 2.64392,-3.01189 3.25252,-4.85596 l 1.10654,-3.35286 -0.91525,-2.39404 c -0.50339,-1.31672 -1.87387,-3.2576 -3.04551,-4.31305 l -2.13026,-1.91902 -5.48299,-0.45469 -5.48298,-0.45469 -1.50152,1.24615 L 121,176.24489 v 6.79577 c 0,3.73767 0.27314,7.50757 0.60699,8.37755 L 122.21398,193 h 6.1705 6.17051 z M 127.25,189.33772 126,188.83333 v -4.94805 -4.94805 l 1.50224,-0.57646 c 2.42395,-0.93016 6.35098,0.49644 7.55393,2.74418 l 1.11389,2.08133 -0.579,2.30693 -0.579,2.30694 -3.15526,1.09992 c -1.73538,0.60496 -3.2006,1.0644 -3.25602,1.02098 -0.0554,-0.0434 -0.66328,-0.30592 -1.35078,-0.58333 z M 0,154.57143 0,150.14286 1.2690348,148.82143 C 7.8010784,142.0197 19,128.47817 19,127.38148 V 126 H 10 1 v -5.52207 -5.52206 l 18.75,0.27206 18.75,0.27207 0.301614,4.12959 0.301614,4.12958 -9.536864,10.87042 c -5.245275,5.97872 -9.543502,11.41602 -9.551614,12.08288 L 20,147.92495 l 9.25,0.28752 9.25,0.28753 0.30226,5.25 0.302259,5.25 H 19.55226 0 Z m 53.415186,3.00716 c -1.696647,-0.73872 -4.059147,-2.5818 -5.25,-4.09572 L 46,150.73028 v -4.94206 -4.94207 l 2.841983,-2.84198 2.841984,-2.84198 4.408016,-1.19235 4.408017,-1.19234 5.785831,0.59966 5.785831,0.59967 0.574121,-1.49614 0.57412,-1.49613 -1.703482,-2.59984 -1.703481,-2.59984 -6.65647,0.53465 c -3.661059,0.29405 -7.894936,0.8451 -9.408616,1.22454 l -2.752146,0.6899 -1.560048,-3.73372 c -0.858027,-2.05354 -1.348389,-4.28529 -1.089694,-4.95944 C 49.057471,117.68666 59.860022,115 66.603714,115 h 5.972506 l 4.403348,2.25 c 2.42184,1.2375 5.324172,3.51311 6.449626,5.0569 l 2.046279,2.80691 0.373205,14.433 c 0.205263,7.93815 0.08971,15.56254 -0.256788,16.94309 L 84.961896,159 h -5.780948 c -3.179521,0 -6.226595,-0.44565 -6.771276,-0.99033 l -0.990327,-0.99033 -3.453071,0.99033 c -4.738353,1.35894 -10.856134,1.1777 -14.551088,-0.43108 z m 17.08609,-8.57908 2.631475,-1.00048 -0.316375,-2.74952 L 72.5,142.5 l -4.12321,-0.86533 -4.12321,-0.86534 -2.864561,1.37295 -2.864561,1.37295 -0.37097,1.92629 -0.370969,1.92629 1.79987,1.31609 c 2.137747,1.56316 7.249001,1.7109 10.918887,0.31561 z m 32.182644,9.29595 c -0.26966,-0.4375 -3.004002,-10.00282 -6.076314,-21.25625 l -5.586021,-20.46079 0.846419,-0.84642 c 0.46553,-0.46553 3.247194,-0.70818 6.181473,-0.53921 l 5.335053,0.30721 1.8601,7.5 c 3.34922,13.5042 3.82173,15 4.73834,15 0.49824,0 2.52818,-5.19679 4.51098,-11.54843 l 3.6051,-11.54842 5.62617,0.29842 5.62618,0.29843 3.33246,10.92483 c 1.83286,6.00865 3.55379,11.14615 3.8243,11.41667 0.90088,0.90087 1.61814,-0.59654 3.11087,-6.49441 0.81393,-3.2159 2.14519,-8.20959 2.95836,-11.09709 l 1.47848,-5.25 h 5.41305 c 2.97717,0 5.63849,0.36477 5.91402,0.8106 0.27554,0.44583 -2.09941,10.23333 -5.27767,21.75 l -5.77865,20.9394 -6.00468,0.2936 -6.00468,0.2936 -0.99539,-1.2936 c -0.54746,-0.71148 -2.27544,-5.70498 -3.83997,-11.09666 -1.56452,-5.39168 -3.21106,-10.02955 -3.65899,-10.30639 -0.98819,-0.61073 -1.85446,1.45229 -5.50471,13.10945 l -2.8182,9 -6.16289,0.29546 c -3.38959,0.1625 -6.38352,-0.0625 -6.65319,-0.5 z m 64.73127,-0.71687 c -1.69665,-0.73872 -4.05915,-2.5818 -5.25,-4.09572 L 160,150.73028 v -4.94206 -4.94207 l 2.84198,-2.84198 2.84199,-2.84198 4.32158,-1.16368 4.32158,-1.16368 6.05998,0.33258 6.05998,0.33259 0.33794,-1.68852 0.33794,-1.68851 -2.17101,-2.17101 -2.171,-2.171 -6.14048,0.54323 c -3.37726,0.29878 -7.36173,0.84742 -8.85436,1.2192 l -2.71388,0.67595 -1.67799,-3.51877 c -0.92289,-1.93533 -1.43047,-4.16379 -1.12796,-4.95213 l 0.55003,-1.43335 5.90744,-1.65755 C 171.97286,115.7459 177.31884,115 180.60371,115 h 5.97251 l 4.40335,2.25 c 2.42184,1.2375 5.32969,3.51925 6.46189,5.07055 l 2.05854,2.82054 0.33429,16.92946 L 200.16858,159 H 193.78429 187.4 l -1.03716,-1.03716 -1.03716,-1.03716 -2.72794,1.03716 c -3.75687,1.42836 -11.46767,1.23321 -15.18255,-0.38425 z m 17.08609,-8.57908 2.63147,-1.00048 -0.31637,-2.74952 L 186.5,142.5 l -4.12321,-0.86533 -4.12321,-0.86534 -2.86456,1.37295 -2.86456,1.37295 -0.37097,1.92629 -0.37097,1.92629 1.79987,1.31609 c 2.13775,1.56316 7.249,1.7109 10.91889,0.31561 z M 0.24115934,53.25 0.5,0.5 100.25,0.24517049 200,-0.00965903 200,52.99517 V 106 H 99.991159 -0.01768132 Z M 165.81795,88.795154 l 5.49301,-2.055197 5.25843,-5.119979 5.25843,-5.119978 1.68514,-5.846638 1.68514,-5.846638 -0.69316,-4.622318 C 182.95347,49.838419 176.16179,41.543059 166.65831,38.38651 l -4.90505,-1.629197 -7.64642,0.442644 -7.64643,0.442645 -5.90534,2.703558 -5.90535,2.703557 -1.07486,-1.091949 -1.07486,-1.09195 2.75,-2.016315 2.75,-2.016316 v -3.294621 -3.294622 l -2.20751,-1.465733 -2.20751,-1.465732 -0.54249,-5.40624 L 132.5,16.5 130.14829,16.16712 c -1.29344,-0.183084 -3.43094,-0.06201 -4.75,0.269052 L 123,17.038104 v 4.945764 4.945764 l -1.93426,1.035184 C 120.0019,28.534167 116.67504,29 113.67273,29 l -5.45875,0 -0.60699,1.581787 c -1.01066,2.633729 -0.68365,6.109703 0.68136,7.242557 0.70859,0.588079 4.19609,1.205679 7.75,1.372445 L 122.5,39.5 l 0.29152,6.01113 0.29151,6.011131 -4.69184,5.488869 C 110.92832,65.741744 106,72.561021 106,74.156728 v 1.47499 l 3.84658,2.161899 3.84658,2.1619 2.02107,-2.227759 c 1.11159,-1.225267 2.82253,-3.488364 3.80208,-5.029105 l 1.781,-2.801346 0.81225,0.812251 c 0.44674,0.446737 0.94234,5.307343 1.10134,10.801346 L 123.5,91.5 h 4.5 4.5 l 0.5,-17.148636 0.5,-17.148637 1.77199,-1.954403 c 0.9746,-1.074922 4.09437,-3.218399 6.93283,-4.763283 l 5.16084,-2.80888 7.06717,-0.43449 7.06717,-0.43449 3.4762,2.370206 c 1.91192,1.303613 4.49942,3.888545 5.75,5.744293 L 173,58.295766 v 4.450988 4.450988 l -1.65629,3.490367 -1.65628,3.490366 -3.59372,2.364168 C 164.11717,77.842935 159.35,79.724882 155.5,80.724746 l -7,1.817935 -0.31487,4.37955 -0.31487,4.37955 1.13297,0.700217 c 1.52771,0.944175 10.07905,-0.686707 16.81472,-3.206844 z M 55.5,87 V 82.5 L 47,81.705734 C 42.325,81.268888 36.531,80.670343 34.124444,80.375633 l -4.375555,-0.535835 -2.462433,-2.462433 -2.462432,-2.462432 0.676162,-4.916284 0.676162,-4.916284 -2.838174,-0.634128 C 21.777178,64.099467 19.825,63.641208 19,63.429883 c -0.825,-0.211324 -2.175,0.03909 -3,0.556471 l -1.5,0.940697 v 7.463144 7.463144 l 2.10453,2.823331 c 2.607413,3.49797 7.366628,6.344118 13.334907,7.974657 L 34.5,91.897277 45,91.698639 55.5,91.5 Z M 69.75,69.89122 c 1.2375,-0.462945 2.247351,-1.190356 2.244114,-1.616469 -0.0032,-0.426113 -1.336335,-5.682569 -2.962441,-11.681014 -1.626106,-5.998444 -2.721899,-11.285944 -2.435097,-11.75 C 66.883378,44.379682 70.907903,44 75.539965,44 h 8.421931 l 0.62746,-2.5 c 0.345103,-1.375 0.345103,-3.625 0,-5 L 83.961896,34 H 74.603393 65.244889 L 64.245837,32.75 C 63.696358,32.0625 62.939523,28.8 62.563982,25.5 62.188441,22.2 61.65259,18.7125 61.373202,17.75 L 60.865225,16 h -4.310168 -4.310168 l -1.013618,1.25 -1.013617,1.25 0.971059,6.320629 c 0.534082,3.476346 0.728155,6.953625 0.431274,7.727287 L 51.080202,33.954573 32.790101,34.227286 14.5,34.5 v 4.5 4.5 l 19.991898,0.5 19.991899,0.5 3.270969,12.413042 c 1.799033,6.827172 3.778711,13.024833 4.399285,13.772578 l 1.128315,1.359536 2.108817,-0.656108 C 66.551032,71.028188 68.5125,70.354166 69.75,69.89122 Z m 8.219949,-43.355011 1.214838,-1.46379 -1.607162,-4.78621 c -0.88394,-2.632415 -1.994303,-5.396811 -2.467474,-6.143101 L 74.24984,12.786215 71.12492,13.472563 68,14.158911 v 1.79842 c 0,0.989132 0.608563,3.315877 1.352362,5.170545 0.743799,1.854668 1.629676,4.159624 1.968615,5.122124 L 71.93723,28 h 2.40894 c 1.324918,0 2.955618,-0.658706 3.623779,-1.463791 z m 9.738781,-2.644939 1.10873,-1.10873 -1.93152,-5.61406 c -2.359378,-6.857654 -2.911343,-7.4511924 -6.168938,-6.633588 -3.641994,0.914082 -3.94741,2.685047 -1.545499,8.961628 L 81.277565,25 h 2.661218 c 1.463669,0 3.160146,-0.498929 3.769947,-1.10873 z"
       id="path1" />
  </g>
</svg>`;
    // main.js
    const defaultExtrusion = 10;
    const app = document.querySelector('#app');
    const { renderer, scene, camera } = setupScene(app);
    const { object } = renderSVG(defaultExtrusion, svg);

    const loader = new THREE.FontLoader();
    const fontGroup = new THREE.Group();

    const fontPromise = new Promise((resolve) => {
      loader.load(
        'https://raw.githubusercontent.com/components-ai/typefaces/main/packages/font-roboto/data/typefaces/roboto-black-normal-900.json',
        function (font) {
          resolve(font);
        }
      );
    });

    scene.add(fontGroup);
    scene.add(object);

    setInterval(refresh, 60000);
    refresh();

    let inc = 0;
    const animate = () => {
      requestAnimationFrame(animate);
      object.rotation.y = Math.sin((inc += 0.002)) * 0.1;
      fontGroup.rotation.y = Math.sin((inc += 0.002)) * 0.1;
      renderer.render(scene, camera);
    };

    animate();

    async function refresh() {
      const font = await fontPromise;
      const response = await fetch(
        'https://api.tipeee.com/v2.0/projects/zawaprod'
      );
      const obj = await response.json();
      const textGeo = new THREE.TextGeometry(
        `${obj.parameters.tipperAmount} €`,
        {
          font: font,
          size: 35,
          height: 5,
          bevelEnabled: false,
        }
      );

      textGeo.computeBoundingBox();

      const centerOffset =
        -0.5 * (textGeo.boundingBox.max.x - textGeo.boundingBox.min.x);

      const textMesh1 = new THREE.Mesh(textGeo, material);

      textMesh1.position.x = centerOffset;
      textMesh1.position.y = -145;
      textMesh1.position.z = 0;

      fontGroup.clear();
      fontGroup.add(textMesh1);
    }
  </script>
</html>
